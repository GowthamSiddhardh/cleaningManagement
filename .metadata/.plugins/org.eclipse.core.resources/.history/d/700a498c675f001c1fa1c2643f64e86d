package com.cleaningmanagement.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

import com.cleaningmanagement.model.Request;

public class RequestDao {
    public boolean insertRequestDetails(Request req)
    {    
    	Connection con=ConnectionClass.getConnection();
    	String query="insert into WMS_request(user_id,emp_id,catogory,location) values(?,?,?,?)";
    	String id="select emp_id from WMS_employee where location= '"+req.location+"'";
    	int empId=0;
    	try {
			Statement st=con.createStatement();
			ResultSet rs=st.executeQuery(id);
			if(rs.next())
			{
				empId=rs.getInt(0);
			}
			PreparedStatement pstmt=con.prepareStatement(query);
			pstmt.setInt(1, req.getUserId());
			pstmt.setInt(2, empId);
			pstmt.setString(3, req.getCatogories());
			pstmt.setString(4, req.getLocation());
			pstmt.executeQuery();
			
		} catch (SQLException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}
    	return true;
    	
    }
}
